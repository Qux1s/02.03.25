По поводу того сложного куска который должен с помощью бола принять решение и вывести значение
Такие куски кода нужно отделаьно писать и тестировать, а не пытаться эти куски сразу запихнуть в программу!!!!!!! 
Вспосни у ткбя даже лекция была что пиши код БЛОЧНО НЕ ПИШИ СРАЗУ ВСЕ ДЕБИЛ-ДЕБИЛОВИЧ